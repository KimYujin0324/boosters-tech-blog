---
layout: post # 고정으로 넣어주세요.
title:  "오래되어 삐걱거리는 Legacy 시스템 업그레이드 과정" # 제목
subtitle: "오래된 레거시 코드를 수정하는 것은 어렵습니다. 오래된 레거시 시스템을 바꾸는 것은 더 어렵습니다. 사용하고 있는 오래된 시스템을 더 오래되고 고장나기 전에 최신의 시스템으로 업그레이드 한 경험을 기술하였습니다." # 소제목으로 글 목록에서 타이틀 아래에 표기됩니다.
author: dilee # 작성자 이름
category: tech # tech, culture 중 택 1
tags: [ ubuntu, Centos, VersionUp, Regacy, Refactoring ] # 원하시는 태그들을 2~6개 넣어주세요. (띄어쓰기 X)
image: assets/images/1.jpg # 고정으로 넣어주세요.
image_count: 3 # 글 예상 소요시간 계산을 위해 해당 포스트에 사용된 사진의 개수를 적어주세요.
---

<!--
개요와 중제목 사이에는 한줄 띄워주시고, 중제목과 중제목 사이에는 두줄 띄워주세요.
문단을 나눌때는 한줄 띄워주세요.
-->

## 해당 포스트는..
> 오랫동안 사용했던 Laravel, php, vue.js, node.js, centos7, Apache, Mysql 등의 기술들을 최신의 버전으로 업그레이드 하는 과정을 담았습니다. 다양한 시행착오 끝에 마무리된 레거시 시스템 업그레이드 프로젝트를 기록합니다.

## 버전업의 필요성을 느끼다.
운영 시스템의 복잡성이 증가함에 따라 사용하고자 하는 기술의 폭이 넓어지고 관련 라이브러리들을 설치할 일들이 종종 생기곤 합니다. 그러나 오래된 시스템과 프레임워크의 버전에 따라 호환되지 않는 라이브러리들이 생기기 시작하고 기술의 한계에 부딪히기 시작했습니다.

먼저 사용중인 웹프레임워크인 Laravel의 버전이 낮음에 따라 Composer로 설치할 수 있는 패키지의 선택의 폭이 좁았습니다. 가장 최근의 Laravel의 버전은 11.x 버전인 데 비해 사용하고 있는 버전은 너무 낮은 버전이었습니다. 부끄럽게도 기존 사용하는 버전은 2019년 8월에 종료된 5.6 버전이었습니다. 가장 먼저 시도한 것이 Laravel8 버전으로 높여보자 였습니다. 5.6에서 6버전까지 올리는데는
composer.json에 버전 명시만 잘해주니 문제없이 진행되었습니다. 그러나 6버전에서 7버전으로 올릴때는 PHP 버전을 높여야하는 이슈가 생겼습니다.

사용중인 PHP 버전은 7.2 버전이었습니다. 7.2버전을 설치할 때는 소스컴파일로 설치를 하였기때문에 7.4버전도 경험에 의한 방법으로 소스컴파일 설치를 진행하였습니다.
```
1. configure: error: Package requirements (gdlib >= 2.1.0) were not met:
2. configure: error: Package requirements (sqlite3 > 3.7.4) were not met:
3. configure: error: Package requirements (icu-uc >= 50.1 icu-io icu-i18n) were not met:
4. configure: error: Package requirements (oniguruma) were not met:
5. configure: error: GD build test failed. Please check the config.log for details.
```
Configure 과정에서 다양한 에러를 만났지만 하나하나 의존성 패키지를 업그레이드 해가며 설치진행하였습니다. 다행이 의존성 문제를 해결하니 7.4버전이 정상 설치되었습니다. PHP 하나 업그레이드 하는데 2~3일 걸리다보니 벌써 마음이 지치긴했지만 성공했다는 기쁨에 팀원들에게 같이 설치과정을 다시 해보자며 회의실에서 이러쿵 저러쿵 무용담을 늘어뜨리기도 했습니다. openssl 이 업그레이드 되어있는 특정 서버에서는 configure 에러가 또 다시 등장하여 애먹긴 하였지만 모든 사용 서버에 PHP7.4 버전업을 성공시켰습니다.

다음은 다시 Laravel을 6버전에서 8버전으로 업그레이드를 시도하였습니다. 다행이 PHP 버전에 따라 Laravel도 8 버전으로 문제없이 업그레이드 되었습니다. 물론 PHP 문법 변경에 따른 소스 수정은 진행하여야 했지만 무사히 프레임워크의 업그레이드를 성공하였습니다. 노션에 주요 변경사항을 기록하여 팀원들과 공유하였습니다.

<p style="text-align: center;">
  <img src="/assets/images/2024-09/post8-change-regacy-refactoring(1).png" alt="Laravel Version UP 노션">
</p>






시스템이 커짐에 따라 기존 사용하는 언어와 프레임워크 및 라이브러리를 바꾸는 것은 굉장히 까다로울 수 있는 일입니다. 단지 까다롭다는 이유만으로 잘되고 있는 시스템을 굳이 버전업할 필요있을까 라는 안일한 생각의 시간들이 큰 기술부채를 만든다는 것을 체감하면서 현재 사용하는 레거시 시스템을 업그레이드 하려고 했습니다.

먼저 사용하고 있는 웹프레임워크인 Laravel Version 업입니다. 부끄럽게도 기존 사용하는 버전은 2019년 8월에 종료된 5.6 버전이었습니다. 버전이 오래됨에 따라 composer로 설치해야하는 패키지도 지원하지 않는 패키지들도 많았습니다. 그에 따른 불편함이 생기면서 최우선으로 업그레이드 해야 했습니다. 목표는 Laravel




## Centos7가 "지원종료" 되다.
부스터스 Tech팀의 운영서버의 OS는 CentOS7이었습니다. 굳이 이유라 하면 처음 CentOS7을 사용한 2016년 이후로 큰 이슈가 없어 바꾸지 않고 그대로 사용했습니다. 그러나 최근들어 사용하고자 하는 기술들의 의존성 문제가 발생하기 시작하면서 OS 변경을 고려하게 되었습니다. 마침 CentOS7의 지원종료 소식도 접했고 앞으로 길게 본다면 더 많은 기술부채가 쌓이기 전에 리팩토링이 필요한 상황이었습니다.

<p style="text-align: center;">
  <img src="/assets/images/2024-09/post8-change-regacy-refactoring(1).PNG" alt="centos7 지원종료">
</p>


## Vue3를 사용하고 싶어요.
처음부터 무작정 서버를 이관할 생각은 없었습니다. 개발자들은 공감하시겠지만 모든 소스를 담고 있는 서버를 바꾼다는 것은 엄청난 리스크를 안아야 하고 별다른 이슈가 없다면 금방 끝나겠지만 결코 그럴수 없는 작업이기 때문에 서버 이관의 카드는 마지막 카드였습니다.


## Laravel, PHP, Vue3, nodejs 버전업
내용을 적어주세요.


## 중제목
내용을 적어주세요.


## 중제목
내용을 적어주세요.

### 소제목
내용을 적어주세요.


<!--
**진하게** // 볼드 처리 하고 싶은 텍스트
`부스터스 TECH 화이팅` // 강조하고 싶은 텍스트, 주황색 텍스트로 나오므로 꼭 필요한 곳만 사용
![이미지 설명](경로) // 마크 다운은 사이즈 조절 불가능 하므로 아래 코드로 이미지 첨부
<p style="text-align: center;">
  <img src="/assets/images/2024-07/이미지명" alt="이미지 설명">
</p>
  -->
