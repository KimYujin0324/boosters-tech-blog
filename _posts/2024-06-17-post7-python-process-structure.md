---
layout: post
title:  "파이썬 프로젝트 구조화 작업"
subtitle: "프로젝트 구조화는 어떤 것이며 왜 해야할까"
author: twkim
category: tech
tags: [ Python, Process, Structure ]
image: assets/images/1.jpg
---

### 해당 포스트는..
>프로젝트 구조화는 프로젝트의 성공과 지속 가능성을 위한 핵심 요소입니다. 특히 여러 개발자가 협업하거나 장기간 유지보수가 필요한 프로젝트에서는 더욱 중요합니다. 프로젝트 구조화란 무엇이며 어떻게 해야할지 고민해보았습니다.


### 5월의 어느날

`[구조화] python_process 구조화` 라는 약간은 부담스러운 티켓이 생성되었습니다.

<p style="text-align: center;">
  <img src="/assets/images/2024-07/post7-python-process-structure(1).png" alt="파이썬프로세스 구조화 아사나 티켓">
</p>

매출 정산을 위한 크롤링 소스가 포함된 기존 파이썬 프로젝트를 구조화하는 작업을 맡게 되어버린 것이었습니다... 기존 코드베이스에 추가하여 다양한 프로세스를 파이썬으로 실행하고자 하는 필요로 인해 포괄적인 프로젝트 구조를 설계해야 했습니다. 코드치고 로직 고민하면 되는 업무들과 다르게 프로젝트의 전반적인 방향성을 결정하는 작업이다보니 함부로 마음대로 하기 망설여졌습니다. 그래서 구조화가 뭐고 어떻게 보통 하는지부터 공부하기 시작했습니다.


### 프로젝트 구조화의 중요성

프로젝트 구조화를 한다는 것은 파일을 **적당한 폴더**에 **잘 분류**하는 것이라 할 수 있습니다.  이 작업은 단순해 보일 수 있지만, 적당히, 잘 이라는 애매하면서 어려운 부사가 2개나 붙었기 때문에 요하면서도 어려운 과제입니다. 적당한 폴더에 잘 나눠진 프로젝트는 높은 응집도와 낮은 결합도를 가지게 됩니다. 높은 응집도란 모듈이나 클래스가 하나의 명확한 책임이나 기능을 가지고 있어, 관련된 코드가 하나의 장소에 집중되어 있는 상태를 말하고 낮은 결합도란 모듈 간의 의존성이 최소화된 상태를 의미합니다. 각 모듈이 다른 모듈에 대해 의존하지 않고 독립적으로 작동할 수 있는 구조를 갖추게 됩니다. 높은 응집도와 낮은 결합도를 가지는 프로젝트는 다섯 가지 주요 장점을 가지고 있습니다.

1. **가독성**

    프로젝트가 체계적으로 정리되면 코드와 폴더 구조가 명확해져, 개발자들이 프로젝트를 쉽게 이해하고 적용할 수 있습니다. 각 부분이 명확하게 구분되어 있어 코드의 기능과 흐름을 쉽게 파악할 수 있습니다.  

2. **유지보수성**
    
    코드의 유지보수성을 높이기 위해서는 변경 사항이 미치는 영향을 최소화하고, 각 기능이 명확하게 분리된 응집도 높은 코드를 작성해야 합니다. 응집도가 높은 코드는 관련 기능들이 하나의 모듈에 집중되어 있어 이해하고 수정하기가 쉽습니다. 잘 구조화된 코드는 각 부분을 독립적으로 수정하고 테스트할 수 있어야 합니다. 이렇게 하면 변경 사항이 특정 부분에 미치는 영향을 최소화할 수 있으며, 전체적인 코드의 안정성과 유지보수성을 높일 수 있습니다.

3. **재사용성**
    
    잘 구조화된 프로젝트는 특정 기능이나 유틸리티가 독립적인 모듈로 분리되어 프로젝트 내에서 필요할 때 쉽게 재사용할 수 있습니다. 모듈로 잘 분리하지 않으면 동일한 기능을 하는 코드를 찾기 어렵거나 새로 만드는 것이 쉬울 정도로 접근하기 힘들어집니다. 결과적으로 코드가 중구난방으로 중복되어 지저분해질 수 있습니다.

4. **협업 효율성**
    
    명확한 구조는 팀 내에서의 역할 분담과 소통을 원활하게 합니다. 각 기능이나 모듈이 명확하게 정의되어 있을 때 개발자들이 각자의 역할에 집중할 수 있고, 필요한 정보나 기능을 쉽게 찾아 활용할 수 있습니다.

5. **테스트 용이성**
    
    테스트 코드를 별도로 관리하면 코드의 신뢰성을 높일 수 있습니다. 각 기능이나 모듈별로 테스트 코드를 작성하고 실행함으로써 버그를 조기에 발견하고 해결할 수 있습니다. 이는 전체 프로젝트의 안정성을 높이는 데 기여합니다.


### Package by Layer vs Package by Feature

그럼 프로젝트 구조화에 대표적인 방식은 어떤 것들이 있을까요? 프로젝트 구조화를 위해 패키지를 구성하는 방법은 크게 `계층별 패키지`와 `기능별 패키지`로 나눠집니다. 각각의 접근 방식은 프로젝트의 특성과 요구사항에 따라 선택할 수 있으며, 장단점이 명확히 구분됩니다.

**Package by Layer(계층별 패키지)** 

계층별 패키지는 프로젝트를 아키텍처적 계층에 따라 패키지화하여 분리하는 방식입니다. 이 방식은 주로 소프트웨어의 아키텍처를 분리하고 각 계층별로 책임을 명확히 할 수 있도록 도와줍니다.

예시:

<p style="text-align: center;">
  <img src="/assets/images/2024-07/package_by_layer_example.png" alt="계층별 패키지 예시">
</p>


- 장점:

    - 각 계층이 명확하게 분리되어 있어 프로젝트에 대한 이해도가 상대적으로 낮더라도 코드의 기능과 전체 프로젝트의 흐름을 쉽게 이해할 수 있습니다. 예를 들어, 비즈니스 로직은 서비스 계층에서, HTTP 요청 처리는 컨트롤러 계층을 확인하여 파악이 가능합니다.

    - 각 계층의 역할이 명확히 정의되어 협업이나 유지보수 시 코드베이스를 이해하는 데 도움이 됩니다.

- 단점:

    - 하나의 기능을 추가하거나 수정하기 위해 코드베이스 전체를 돌아다니며 작업해야 할 수 있습니다.예를 들어, 새로운 회원 기능을 추가할 때 컨트롤러, 서비스, 모델 계층 모두를 수정해야 할 수 있습니다.

계층별 패키지 구조는 프로젝트의 구조적 명확성을 제공하는 반면, 기능 추가나 수정 시 코드베이스 전체를 수정해야 하는 단점도 가지고 있습니다. 따라서, 계층별 패키지 구조를 효과적으로 활용하기 위해서는 객체지향 설계 원칙과 단일 책임 원칙을 철저히 준수해야 합니다. 각 계층의 역할과 책임을 명확히 하여 낮은 결합도와 높은 응집도를 유지함으로써, 코드 변경의 영향을 최소화하고 시스템의 유연성과 유지보수성을 높일 수 있습니다.


**Package by Feature(기능별 패키지)**

기능별 패키지 구조는 프로젝트의 기능 또는 모듈을 기준으로 패키지를 구성하는 방식입니다. 이러한 구조는 각 기능이 독립적이고 자급자족하게 동작할 수 있도록 합니다.

예시 :

<p style="text-align: center;">
  <img src="/assets/images/2024-07/package_by_feature_example.png" alt="기능별 패키지 예시">
</p>

- 장점:

    - 각 기능이 독립적으로 동작하도록 구성되어 있어 모듈화가 잘 이루어지며, 이는 코드의 이해도와 유지보수성을 높입니다.
    
    - 관련된 클래스와 인터페이스가 한 곳에 모여 있어 응집도가 높아지고, 특정 기능을 찾고 수정하는 데 걸리는 시간을 줄여줍니다.

    - 각 기능이 독립적으로 개발되고 유지보수될 수 있어 결합도가 낮아 한 기능의 변경이 다른 기능에 미치는 영향을 최소화합니다.

- 단점:

    - 유사한 기능이나 유틸리티 코드가 여러 패키지에 중복될 가능성이 있습니다.

    - 프로젝트 전반의 흐름을 파악하기 어려울 수 있습니다.

    - 패키지 간에 순환참조가 발생할 수 있습니다.

기능별 패키지 구조는 모듈화된 코드베이스를 제공하여 높은 응집도와 낮은 결합도를 유지하는 데 도움이 됩니다. 그러나 코드 중복과 초기 설계의 복잡성 등 몇 가지 단점도 존재합니다. 이러한 구조를 효과적으로 활용하기 위해서는 기능 간의 공통 요소를 잘 관리하고, 초기 설계를 신중하게 수행하는 것이 중요합니다. 기능별 패키지 구조는 특히 대규모 프로젝트나 마이크로서비스 아키텍처에서 유용하게 활용될 수 있습니다.


### 정석적인 파이썬 프로젝트 구조란?

파이썬은 매우 유연한 언어이기 때문에 프로젝트 구조에 대한 정해진 규칙이 없습니다. 이러한 패키지 구분 방식을 고려하여 파이썬 프로젝트에도 유사한 접근 방식을 적용할 수 있었습니다. 몇 가지 원칙을 세우고, 계층별 패키지 방식과 기능별 패키지 방식을 적절히 혼합하여 프로젝트 구조를 설계했습니다.

1. **공통 함수 구성**

    프로젝트의 코드를 가능한 작은 모듈로 나누어 관리합니다. 공통 기능을 가진 파일은 **_lib/** 디렉토리에 모아 클래스로 구성합니다.

2. **폴더링된 소스 코드**

    프로젝트의 핵심 기능이 동작하는 코드는 **src/** 디렉토리 아래 기능별로 분류합니다. 이렇게 하면 각 기능을 쉽게 찾고 관리할 수 있습니다.

3. **모듈화된 함수 구성**

    필요한 코드는 각각의 기능을 수행하는 함수로 작성하고 **modules/** 디렉토리에 넣습니다. 이렇게 하면 코드 재사용성이 높아지고 유지보수도 쉬워집니다. 또한 modules 아래 긴으별로 패키지를 나누어 각 기능에 대한 모듈을 한 폴더에서 관리하기 쉽게했습니다.

4. **명확한 파일 이름**
    
    모듈 파일 이름은 해당 모듈이 어떤 기능을 수행하는지 명확하게 드러나도록 지어야 합니다. 이는 다른 개발자가 프로젝트를 이해하고 사용할 때 도움이 됩니다.

5. **데코레이터 활용**

    파이썬의 강력한 기능 중 하나인 데코레이터를 적극적으로 활용하여 코드의 효율성을 높이고 중복을 줄입니다. 예를 들어, 로깅, 인증, 성능 측정 등 여러 측면에서 유용하게 활용할 수 있습니다.


### 유연한 구조화: 부스터스 테크팀의 파이썬 프로젝트 접근법

이번 파이썬 프로젝트 구조화에서 가장 중점적으로 고려했던 부분은 바로 유지보수의 용이성과 코드의 재사용성이었습니다. 부스터스 테크팀에서는 지속적이고 빠른 개발이 동시에 이루어져야 하기 때문에, 이러한 요소들은 프로젝트의 성공과 효율적인 운영을 위해 필수적인 조건입니다.

구조화 작업을 진행하면서 "유연한 구조화"라는 다소 모순된 개념에 집중하게 되었습니다. 구조화라는 단어는 자칫하면 변경될 수 없는 고정된 규칙을 의미하는 것처럼 보일 수 있지만, 실제로는 프로젝트의 진행 상황과 팀의 요구사항이 끊임없이 변화합니다. 이에 발맞추어 유연하게 대응할 수 있는 구조화가 필요하다고 생각했습니다. 정해진 틀에 얽매이지 않고 필요에 따라 구조를 수정하고 개선해나가는 접근 방식이 중요하다고 보았습니다.

이를 통해 부스터스 테크팀은 변화하는 요구사항에 유연하게 대응하면서도 명확하고 효율적인 프로젝트 구조를 유지하려 합니다. 이는 단순히 프로젝트의 성공뿐만 아니라 지속적인 성장을 위한 견고한 기반을 마련하는 데에도 큰 도움이 될 것입니다.
